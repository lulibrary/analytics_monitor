<html>
<head>
    <meta http-equiv="refresh" content="15">
    <script type="text/javascript"
            src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load("visualization", "1.1",
                {packages: ["corechart", "line", "calendar",
                    "gauge", "scatter", "table"]});
        google.setOnLoadCallback(drawChartCalendar);
        google.setOnLoadCallback(drawChartPct);
        google.setOnLoadCallback(drawChartPctNoWE);
        google.setOnLoadCallback(drawChartAvg);
        google.setOnLoadCallback(drawChartMode);
        google.setOnLoadCallback(drawChartMaxMin);
        google.setOnLoadCallback(drawChartGauge);
        google.setOnLoadCallback(drawChartOutTable);
        google.setOnLoadCallback(drawChartPctTable);
        google.setOnLoadCallback(drawChartMonthPctTable);

        function drawChartCalendar() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn({type: 'date', id: 'Date'});
            dataTable.addColumn({type: 'number', id: '% up'});
            dataTable.addColumn({type: 'string', role: 'tooltip', 'p': {'html': true}})
            dataTable.addRows([
                //DATA1
            ]);
            var chart = new google.visualization.Calendar(
                    document.getElementById('chart_calendar'));
            var options = {
                title: "Analytics % Availability - " +
                "//INSTITUTION - //ALMA_INSTANCE",
                calendar: {
                    cellSize: 16,
                    colorAxis: {
                        colors: ['red', 'green']
                    }
                },
                tooltip: { isHtml: true },
                backgroundColor: "//BG_COLOUR"
            };
            chart.draw(dataTable, options);
        }

        function drawChartPct() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn('date', 'Date');
            dataTable.addColumn('number', '%Uptime');
            dataTable.addRows([
                //DATA8
            ]);
            var chart = new google.visualization.LineChart(
                    document.getElementById('chart_pct'));
            var options = {
                title: "Analytics % Uptime - " +
                "//INSTITUTION - //ALMA_INSTANCE",
                height: 250,
                curveType: 'none',
                hAxis: {format: 'dd/MM/yy'},
                backgroundColor: "//BG_COLOUR",
                vAxis: {
                    title: '%Uptime',
                    viewWindowMode: 'maximized'
                },
                trendlines: {
                    0: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'green',
                        lineWidth: 3,
                        opacity: 0.5,
                        labelInLegend: '%Uptime Trend',
                        visibleInLegend: true
                    }
                }
            };
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'EEEE, dd/MM/yyyy'});
            formatter.format(dataTable, 0);
            chart.draw(dataTable, options);
        }

        function drawChartPctNoWE() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn('date', 'Date');
            dataTable.addColumn('number', '%Uptime');
            dataTable.addRows([
                //DATA9
            ]);
            var chart = new google.visualization.LineChart(
                    document.getElementById('chart_pct_nowe'));
            var options = {
                title: "Analytics % Uptime (excluding weekends) - " +
                "//INSTITUTION - //ALMA_INSTANCE",
                height: 250,
                curveType: 'none',
                hAxis: {format: 'dd/MM/yy'},
                backgroundColor: "//BG_COLOUR",
                vAxis: {
                    title: '%Uptime',
                    viewWindowMode: 'maximized'
                },
                trendlines: {
                    0: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'green',
                        lineWidth: 3,
                        opacity: 0.5,
                        labelInLegend: '%Uptime Trend',
                        visibleInLegend: true
                    }
                }
            };
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'EEEE, dd/MM/yyyy'});
            formatter.format(dataTable, 0);
            chart.draw(dataTable, options);
        }

        function drawChartAvg() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn('date', 'Date');
            dataTable.addColumn('number', 'Average');
            dataTable.addColumn('number', 'Median\n(Middle)');
            dataTable.addRows([
                //DATA2
            ]);
            var chart = new google.visualization.LineChart(
                    document.getElementById('chart_average'));
            var options = {
                title: "Analytics Response Time - Average & Median " +
                    "- //INSTITUTION - //ALMA_INSTANCE",
                height: 250,
                curveType: 'none',
                hAxis: {format: 'dd/MM/yy'},
                backgroundColor: "//BG_COLOUR",
                focusTarget: 'category',
                vAxis: {
                    title: 'Resp. time in seconds',
                    viewWindowMode: 'pretty'
                },
                trendlines: {
                    0: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'green',
                        lineWidth: 4,
                        opacity: 0.6,
                        labelInLegend: 'Avg. Trend',
                        visibleInLegend: true
                    },
                    1: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'orange',
                        lineWidth: 4,
                        opacity: 0.6,
                        labelInLegend: 'Med. Trend',
                        visibleInLegend: true
                    }
                }
            };
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'EEEE, dd/MM/yyyy'});
            formatter.format(dataTable, 0);
            chart.draw(dataTable, options);
        }

        function drawChartMode() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn('date', 'Date');
            dataTable.addColumn('number', 'Mode\n(Most likely)');
            dataTable.addRows([
                //DATA3
            ]);
            var chart = new google.visualization.LineChart(
                    document.getElementById('chart_mode'));
            var options = {
                title: "Analytics Response Time - Mode - " +
                    "//INSTITUTION - //ALMA_INSTANCE",
                height: 250,
                curveType: 'none',
                hAxis: {format: 'dd/MM/yy'},
                backgroundColor: "//BG_COLOUR",
                vAxis: {
                    title: 'Resp. time in seconds',
                    viewWindowMode: 'pretty'
                },
                trendlines: {
                    0: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'green',
                        lineWidth: 3,
                        opacity: 0.5,
                        labelInLegend: 'Mode Trend',
                        visibleInLegend: true
                    }
                }
            };
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'EEEE, dd/MM/yyyy'});
            formatter.format(dataTable, 0);
            chart.draw(dataTable, options);
        }

        function drawChartMaxMin() {
            var dataTable = new google.visualization.DataTable();
            dataTable.addColumn('date', 'Date');
            dataTable.addColumn('number', 'Max');
            dataTable.addColumn('number', 'Min');
            dataTable.addRows([
                //DATA4
            ]);
            var chart = new google.visualization.LineChart(
                    document.getElementById('chart_max_min'));
            var options = {
                title: "Analytics Response Time Max/Min - " +
                    "//INSTITUTION - //ALMA_INSTANCE",
                height: 250,
                curveType: 'none',
                hAxis: {format: 'dd/MM/yy'},
                vAxis: {
                    viewWindowMode: 'pretty'
                },
                backgroundColor: "//BG_COLOUR",
                focusTarget: 'category',
                vAxis: {title: 'Resp. time in seconds'},
                trendlines: {
                    0: {
                        tooltip: false,
                        type: 'polynomial',
                        color: 'green',
                        lineWidth: 3,
                        opacity: 0.5,
                        labelInLegend: 'Max Trend',
                        visibleInLegend: true
                    }
                }
            };
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'EEEE, dd/MM/yyyy'});
            formatter.format(dataTable, 0);
            chart.draw(dataTable, options);
        }

        function drawChartGauge() {
            var data = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['Seconds', //AA_RESPONSE
                ]
            ]);
            var options = {
                width: 140, height: 140,
                redFrom: 8, redTo: 10,
                yellowFrom: 6, yellowTo: 8,
                greenFrom: 0, greenTo: 6,
                minorTicks: 10,
                max: 10, min: 0,
                backgroundColor: "//BG_COLOUR"
            };
            var chart = new google.visualization.Gauge(
                    document.getElementById('chart_gauge'));
            chart.draw(data, options);
        }

        function drawChartOutTable() {
            var data = new google.visualization.DataTable();
            data.addColumn('datetime', 'Start');
            data.addColumn('datetime', 'End');
            data.addColumn('number', 'Length');
            data.addRows([
                //DATA7
            ]);

            var table = new google.visualization.Table(
                    document.getElementById('chart_outage_table'));
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'dd/MM/yyyy HH:mm:ss - EEEE'});
            formatter.format(data, 0);
            formatter.format(data, 1);
            table.draw(data, {
                sortAscending: false,
                sortColumn: 0,
                allowHtml: true,
                showRowNumber: true,
                width: '75%',
                alternatingRowStyle: true,
                page: 'enable',
                pageSize: 20
            });
        }

        function drawChartPctTable() {
            var data = new google.visualization.DataTable();
            data.addColumn('datetime', 'Day');
            data.addColumn('number', '%');
            data.addColumn('number', 'Hours');
            data.addColumn('number', 'Avg.');
            data.addColumn('number', 'Median');
            data.addColumn('number', 'Mode');
            data.addColumn('number', 'Min');
            data.addColumn('number', 'Max');
            data.addRows([
                //DATA5
            ]);

            var table = new google.visualization.Table(
                    document.getElementById('chart_pct_table'));
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'dd/MM/yyyy - EEEE'});
            formatter.format(data, 0);
            table.draw(data, {
                sortAscending: false,
                sortColumn: 0,
                allowHtml: true,
                showRowNumber: false,
                width: '100%',
                alternatingRowStyle: true,
                page: 'enable',
                pageSize: 20
            });
        }

        function drawChartMonthPctTable() {
            var data = new google.visualization.DataTable();
            data.addColumn('datetime', 'Month');
            data.addColumn('number', '%');
            data.addRows([
                //DATA6
            ]);

            var table = new google.visualization.Table(
                    document.getElementById('chart_mp_table'));
            var formatter = new google.visualization.DateFormat(
                    {pattern: 'yyyy - MMMM'});
            formatter.format(data, 0);
            table.draw(data, {
                sortAscending: false,
                sortColumn: 0,
                allowHtml: true,
                showRowNumber: false,
                width: '75%',
                alternatingRowStyle: true,
                page: 'enable',
                pageSize: 20
            });
        }
    </script>
</head>
<body bgcolor="//BG_COLOUR">

<style>
    .google-visualization-table-th {
        text-align: left !important;
        background-color: whitesmoke;
        font-size: 15px;
        border: solid;
        border-bottom-color: darkgreen !important;
    }
    .google-visualization-table-td {
        text-align: left !important;
        font-size: 15px;
    }
</style>
<style>
    a.source_link:link {text-decoration: none; color: #959595}
    a.source_link:visited {text-decoration: none; color: #959595}
    a.source_link:hover {text-decoration: underline; color: darkgreen}
    a.source_link:active {text-decoration: none; color: #959595}
</style>

<section style="position: relative; width:95%; height: 140px;
    margin: auto; padding: 5px;">
    <div style="float: left; width:20%; height: 140px; margin-top: 25px;">
        <div>
            <a href="//LOGO_LINK_URI">
                <img style="width: 140%;"
                     src="//LOGO_IMG_URI">
            </a>
        </div>
        <div>
            <p style="padding-left: 40px; color: #959595;
                font-family: sans-serif; font-size: 11px;">
                <a class="source_link"
                    href="https://github.com/lulibrary/analytics_monitor">
                    Source code @github
                </a>
                <br/>
                <a class="source_link" href="alma_analytics.log.gz">
                    Log file (//NUM_DATA_POINTS data points used)
                </a>
            <p>
        </div>
    </div>
    <div style=" width: 65%; float: left; height: 140px;
        font-family: sans-serif; margin-top: 5px;">
        <p style="text-align: center; color: #959595;
            font-family: sans-serif; font-size: small;">
            //CURRENT_DT
        </p>
        <h1 style="color: //HEADING_COLOUR; text-align:
            center; padding-top: 0px;">
            Analytics - //INSTITUTION - //ALMA_INSTANCE -
            is //AA_STATE
        </h1>
        <p style="text-align: center; font-family: sans-serif;
            color: //HEADING_COLOUR; font-size: small;">
            since //CURRENT_STATE_START for //CURRENT_STATE_TIME
        </p>
    </div>
    <div id="chart_gauge"
        style="float: right; width: 15%; height: 140px;"></div>
</section>

<div id="chart_calendar" style="width: 980px; height: auto;
    overflow: hidden; margin-top: 45px; margin-left: auto;
    margin-right: auto;"></div>
<div id="chart_pct" style="width: 100%; height: auto;"></div>
<div id="chart_pct_nowe" style="width: 100%; height: auto;"></div>
<div id="chart_average" style="width: 100%; height: auto;"></div>
<div id="chart_mode" style="width: 100%; height: auto;"></div>
<div id="chart_max_min" style="width: 100%; height: auto;"></div>
<div align="center">
    <h5 style="margin-top: 60px; font-family:
        sans-serif; font-size: 16px;">
        Analytics monthly availability - //INSTITUTION - //ALMA_INSTANCE
    </h5>
    <div id="chart_mp_table" style="display: block; margin: 0 auto;
        width: 70%;"></div>
</div>
<div align="center">
    <h5 style="margin-top: 60px; font-family:
        sans-serif; font-size: 16px;">
        Analytics daily availability and response times - //INSTITUTION - //ALMA_INSTANCE
    </h5>
    <div id="chart_pct_table" style="display: block; margin: 0 auto;
        width: 70%;"></div>
</div>
<div align="center">
    <h5 style="margin-top: 60px; font-family:
        sans-serif; font-size: 16px;">
        Analytics outages - //INSTITUTION - //ALMA_INSTANCE
        (>=//OUTMINS minutes),
        including scheduled maintenance.
    </h5>
    <div id="chart_outage_table" style="display: block; margin: 0 auto;
        width: 100%;"></div>
</div>
</body>
</html>